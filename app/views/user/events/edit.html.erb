<div class="container">
  <div class="row">
    <div class="col-8">
      <h3 class="my-3">イベント編集</h3>
      <%= form_with model:@event,url: event_path(@event.id), local:true do |f| %>
        <div class="form-group">
          <%= f.label :イベント名 %>
          <%= f.text_field :event_name, class: 'form-control' %>
        </div>
        <div class="form-group">
          <%= f.label :イベント内容 %>
          <%= f.text_field :event_content, class: 'form-control' %>
        </div>
        <div class="form-group">
          <%= f.label :年月日 %>
          <%= f.date_field :event_date, class: 'form-control' %>
        </div>
        <div class="form-group">
          <%= f.label :時間 %>
          <%= f.time_field :event_time, class: 'form-control' %>
        </div>
        <div class="form-group relationship_genres-field">
            <%= f.label "タグ" %>
            <%= f.hidden_field :tag_ids, value: "", id: "form_tags" %>
              <% @tags.each_with_index do |tag, index| %>
                <div class="tags_data">
                  <button type="button" value=<%= index %> class="btn btn-success" id="btn_relationship_genres_<%= index+1 %>">
                    <%= tag.tag_name %>
                  </button>
                </div>
              <% end %>
          </div>
        
        
        <%= f.submit "変更を保存", class: 'btn btn-success' %>
      <% end %>
    </div>
  </div>
</div>


<script>
  $('.tags_data').each(function(index) {
    const tag_id = '#btn_relationship_genres_' + (index+1)
    // クリックしたら色が変わる
    $(tag_id).on('click',function(){
      // リセット
      const tags = [];
      $(this).toggleClass('btn-dark');
      // 色が変わったデータを読み取る
      $('.btn-dark').each(function(i) {
        var num = this.value
        // pushでデータの中身を送る
        tags.push(gon.tags[num].id);
      })
      $('#form_tags').val(tags)
    });
  });
</script>